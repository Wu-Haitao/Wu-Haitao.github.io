<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>计算机组成-知识点整理（上） | Haitao 的博客</title><meta name="keywords" content="Computer Architecture"><meta name="author" content="Wu Haitao"><meta name="copyright" content="Wu Haitao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Introduction &amp; Microprocessor ConceptsFunctional Units Processor ComponentsArithmetic &amp; Logic Unit (ALU) for performing arithmetic &amp; logical operations, usually on word*-size data operands">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机组成-知识点整理（上）">
<meta property="og:url" content="https://wu-haitao.github.io/posts/2021-04-08-01/index.html">
<meta property="og:site_name" content="Haitao 的博客">
<meta property="og:description" content="Introduction &amp; Microprocessor ConceptsFunctional Units Processor ComponentsArithmetic &amp; Logic Unit (ALU) for performing arithmetic &amp; logical operations, usually on word*-size data operands">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wu-haitao.github.io/img/bg4.jpg">
<meta property="article:published_time" content="2021-04-08T23:28:40.000Z">
<meta property="article:modified_time" content="2024-05-05T19:58:21.922Z">
<meta property="article:author" content="Wu Haitao">
<meta property="article:tag" content="Computer Architecture">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wu-haitao.github.io/img/bg4.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://wu-haitao.github.io/posts/2021-04-08-01/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":false,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机组成-知识点整理（上）',
  isPost: true,
  isHome: false,
  isHighlightShrink: undefined,
  isToc: true,
  postUpdate: '2024-05-05 19:58:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Haitao 的博客" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="loader-box"></div><div class="my-loader"></div></div><div id="web_bg_container_not_home"><div id="web_bg_not_home">     </div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.webp" onerror="onerror=null;src='/img/404.png'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">65</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/server/"><i class="fa-fw fas fa-server"></i><span> 服务器</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-pen-nib"></i><span> 文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-laugh-squint"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/steamgames/"><i class="fa-fw fab fa-steam-symbol"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/tmdbList/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 摄影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-toolbox"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://my-project-wu-haitao.vercel.app/ui/"><i class="fa-fw fab fa-buffer"></i><span> 博客留言管理</span></a></li><li><a class="site-page child" href="/tools/html_css_js_editor.html"><i class="fa-fw fas fa-code"></i><span> HTML/CSS/JavaScript 测试</span></a></li><li><a class="site-page child" href="/tools/regular_expression_tools.html"><i class="fa-fw fas fa-code"></i><span> 正则表达式</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Haitao 的博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/server/"><i class="fa-fw fas fa-server"></i><span> 服务器</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-pen-nib"></i><span> 文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-laugh-squint"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/steamgames/"><i class="fa-fw fab fa-steam-symbol"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/tmdbList/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 摄影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-toolbox"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://my-project-wu-haitao.vercel.app/ui/"><i class="fa-fw fab fa-buffer"></i><span> 博客留言管理</span></a></li><li><a class="site-page child" href="/tools/html_css_js_editor.html"><i class="fa-fw fas fa-code"></i><span> HTML/CSS/JavaScript 测试</span></a></li><li><a class="site-page child" href="/tools/regular_expression_tools.html"><i class="fa-fw fas fa-code"></i><span> 正则表达式</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计算机组成-知识点整理（上）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2021-04-08T23:28:40.000Z" title="undefined 2021-04-08 23:28:40">2021-04-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">课程学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Introduction-amp-Microprocessor-Concepts"><a href="#Introduction-amp-Microprocessor-Concepts" class="headerlink" title="Introduction &amp; Microprocessor Concepts"></a>Introduction &amp; Microprocessor Concepts</h1><h2 id="Functional-Units"><a href="#Functional-Units" class="headerlink" title="Functional Units"></a>Functional Units</h2><p><img src="1.png"></p>
<h2 id="Processor-Components"><a href="#Processor-Components" class="headerlink" title="Processor Components"></a>Processor Components</h2><p><strong>Arithmetic &amp; Logic Unit (ALU)</strong> for performing arithmetic &amp; logical operations, usually on word<sup>*</sup>-size data operands.</p>
<p><strong>Timing &amp; Control Unit (CU)</strong> for fetching program instructions &amp; data from memory, executing them one after another, &amp; transferring the results back to memory.</p>
<p><strong>Registers</strong> (typically 16 or 32), small amounts of fast storage each of which holds one word<sup>*</sup> of data. Usually classified into general-purpose &amp; special-purpose:</p>
<ul>
<li><p>Program Counter (PC)</p>
</li>
<li><p>Link Register (LR)</p>
</li>
<li><p>Instruction Register<sup>#</sup> (IR)</p>
</li>
<li><p>Stack Pointer (SP)</p>
</li>
</ul>
<p><em>*architecture-dependent; #read-only</em></p>
<h3 id="The-Registers"><a href="#The-Registers" class="headerlink" title="The Registers"></a>The Registers</h3><p>The <strong>General purpose registers</strong> hold data &amp; addresses.</p>
<p>The <strong>PC</strong> register holds the memory address of the current/next instruction.</p>
<p>The <strong>IR</strong> holds the current instruction.</p>
<p>The <strong>LR</strong> stores the return address when a subroutine/function is called.</p>
<p>The <strong>SP</strong> holds the memory address of the last (most recent) data in the stack memory.</p>
<h2 id="Memory-Organization"><a href="#Memory-Organization" class="headerlink" title="Memory Organization"></a>Memory Organization</h2><p>Memory consists of many millions of cells. Each cell holds a bit of information, 0 or 1.</p>
<p>Information usually handled in larger units: words/bytes.</p>
<p>A word is a group of n consecutive bits. A word length is usually between 16 and 64 bits. The memory is thus a collection of consecutive words of the size specified by the word length.</p>
<p>In our 32-bit ARM context:</p>
<ul>
<li>word = 32 bits</li>
<li>byte = 8 bits</li>
</ul>
<h2 id="Instructions-amp-Sequencing"><a href="#Instructions-amp-Sequencing" class="headerlink" title="Instructions &amp; Sequencing"></a>Instructions &amp; Sequencing</h2><p>Basic types of instruction a computer must support:</p>
<ul>
<li>Data transfers to &amp; from the memory, e.g. load, store</li>
<li>Arithmetic &amp; logical operations on data, e.g. add, or</li>
<li>Program sequencing &amp; control, e.g. branch</li>
</ul>
<h3 id="RISC-amp-CISC"><a href="#RISC-amp-CISC" class="headerlink" title="RISC &amp; CISC"></a>RISC &amp; CISC</h3><p>RISC: Reduced Instruction Set Computers</p>
<p>CISC: Complex Instruction Set Computers</p>
<table>
<thead>
<tr>
<th>RISC</th>
<th>CISC</th>
</tr>
</thead>
<tbody><tr>
<td>Simple Instruction Type; Reduced Set</td>
<td>Complex; Extended Set</td>
</tr>
<tr>
<td>Fixed Instruction Length: One Word</td>
<td>Variable Instruction Length: Multi-Word</td>
</tr>
<tr>
<td>One Cycle/Instruction (Except Load &amp; Store)</td>
<td>Multiple Cycles/Instruction</td>
</tr>
<tr>
<td>Instructions Accessing Memory: Load &amp; Store</td>
<td>Almost All Instructions From The Set</td>
</tr>
<tr>
<td>Arithmetic/Logic Operands Must Be In Registers</td>
<td>Allow Direct Memory Operations</td>
</tr>
<tr>
<td>Limited Addressing Mode</td>
<td>Compound Addressing Mode</td>
</tr>
</tbody></table>
<h3 id="RISC-Instruction-Set"><a href="#RISC-Instruction-Set" class="headerlink" title="RISC Instruction Set"></a>RISC Instruction Set</h3><p>Almost all RISC instructions occupy a single word each.</p>
<p>An instruction specifies an operation &amp; the locations of its data operands.</p>
<p>A load/store architecture means:</p>
<ul>
<li>Only Load &amp; Store instructions are used to access memory operands</li>
<li>Operands for arithmetic/logical instructions must be in Registers, or one of them may be given explicitly</li>
</ul>
<p>Instructions &amp; data are stored in the memory. Contents of processor Registers are initially invalid.</p>
<p>Because RISC operates on Register operands, data must be transferred into Register before ALU ops. The Load instruction is used for this purpose. Conversely, the Store instruction is used to transfer data from Register to memory.</p>
<h3 id="Instruction-Execution-Sequencing"><a href="#Instruction-Execution-Sequencing" class="headerlink" title="Instruction Execution/Sequencing"></a>Instruction Execution/Sequencing</h3><p>How is the RISC program executed?</p>
<p>Every instruction is executed with the following steps:</p>
<ol>
<li><strong>Fetch Instruction</strong> – Read instruction from memory</li>
<li><strong>Decode Instruction</strong> – Determine action required</li>
<li><strong>Fetch Data</strong> – Read data from memory</li>
<li><strong>Process Data</strong> – Perform arithmetic/logical operations</li>
<li><strong>Write Data</strong> – Write result to memory</li>
</ol>
<p>Address for first instruction is placed in PC. CU <strong>fetches &amp; executes</strong> instructions, one after another. During the execution of each instruction, PC register is always incremented by 4 by default, unless told otherwise (e.g. in branching &amp; looping).</p>
<ul>
<li><p><strong>Fetch</strong>-phase:</p>
<ul>
<li>CU reads value in PC for the address of current instruction</li>
<li>CU transfers and places the machine instruction into IR</li>
</ul>
</li>
<li><p><strong>Execute</strong>-phase:</p>
<ul>
<li>CU decodes machine instruction in IR</li>
<li>The specified operation is performed in steps, e.g. CU transfers operands, ALU performs arithmetic/logical ops</li>
<li>Also, PC is incremented, pointing at the next instruction, ready for the next fetch</li>
</ul>
</li>
</ul>
<h3 id="Branching-amp-Looping"><a href="#Branching-amp-Looping" class="headerlink" title="Branching &amp; Looping"></a>Branching &amp; Looping</h3><p>A branch instruction works by:</p>
<ul>
<li>Placing the address containing the required instruction into PC</li>
<li>Then fetching &amp; executing that instruction (&amp; all subsequent ones) until the end of program/another branching occurs</li>
</ul>
<p>A loop can be implemented by:</p>
<ul>
<li>Branching repeatedly to the start of a section of a program until some terminating condition is satisfied</li>
</ul>
<p>Processor maintains the information on arithmetic or logical operation results to affect subsequent conditional branches, thus altering the program flow.</p>
<h1 id="ARM-Cortex-M3-NXP-LPC1769"><a href="#ARM-Cortex-M3-NXP-LPC1769" class="headerlink" title="ARM Cortex-M3 NXP LPC1769"></a>ARM Cortex-M3 NXP LPC1769</h1><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p><img src="2.png"></p>
<ul>
<li>Operates at 120 MHz</li>
<li>100 pin packaging</li>
<li>Cortex-M3 processor (32-bit)</li>
<li>Uses a modified Harvard architecture</li>
<li>Incorporates a 3-stage pipeline</li>
<li>512 KB of Flash Memory</li>
<li>64 KB on-chip SRAM</li>
</ul>
<p>……</p>
<h3 id="Registers"><a href="#Registers" class="headerlink" title="Registers"></a>Registers</h3><p>Cortex-M3 processor has sixteen 32-bits registers (R0–R15).</p>
<p>R0–R12: General-Purpose Registers for data operations</p>
<ul>
<li><p>R0-R7: low registers</p>
</li>
<li><p>R8-R12: high registers</p>
<p>This differentiation is only meaningful to interrupts.</p>
</li>
</ul>
<p>R13: Special-Purpose Register, Contains two Stack Pointers</p>
<ul>
<li>Main Stack Pointer (MSP): default stack pointer, used by the operating system (OS) kernel &amp; exception handlers</li>
<li>Process Stack Pointer (PSP): used by user application code</li>
</ul>
<p>R14: Link Register (LR)</p>
<ul>
<li>Stores the return address when a subroutine/function is called</li>
</ul>
<p>R15: Program Counter (PC)</p>
<ul>
<li>Holds the memory address of the current/next instruction</li>
<li>Can be written to control the program flow, e.g. branching</li>
</ul>
<p>Instruction Register (IR)</p>
<ul>
<li>Not shown/accessible</li>
<li>Read-only by CU</li>
</ul>
<p><img src="3.png"></p>
<h1 id="ARM-Instruction-Set-amp-Assembly-Language-ASM"><a href="#ARM-Instruction-Set-amp-Assembly-Language-ASM" class="headerlink" title="ARM Instruction Set &amp; Assembly Language (ASM)"></a>ARM Instruction Set &amp; Assembly Language (ASM)</h1><h2 id="Introduction-to-ARMv7-M"><a href="#Introduction-to-ARMv7-M" class="headerlink" title="Introduction to ARMv7-M"></a>Introduction to ARMv7-M</h2><p>Assembly programs are quicker, smaller &amp; have larger capabilities than those created with high-level languages.</p>
<p>However, developing applications with assembly is tedious &amp; error-prone.</p>
<p>Combination of C and asm is a powerful method.</p>
<h3 id="Calling-an-Assembler-Function-from-a-C-Program"><a href="#Calling-an-Assembler-Function-from-a-C-Program" class="headerlink" title="Calling an Assembler Function from a C Program"></a>Calling an Assembler Function from a C Program</h3><p>Call assembler function from C program (.c)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">int</span> <span class="title function_">my_asm_func</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Input parameters: R0, R1, R2, R3 (maximum of 4)</p>
</li>
<li><p>Output (return) parameter: R0</p>
</li>
</ul>
<p>Define assembler function in asm program (.s)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my_asm_func: ...</span><br></pre></td></tr></table></figure>

<ul>
<li><p>It will be treated as just another subroutine by C program</p>
</li>
<li><p><code>my_asm_func</code> usually ends with <code>BX LR</code> to return to the calling C program</p>
</li>
</ul>
<h3 id="Some-Basics"><a href="#Some-Basics" class="headerlink" title="Some Basics"></a>Some Basics</h3><h4 id="Label"><a href="#Label" class="headerlink" title="Label"></a>Label</h4><p>A label is a symbol that represents the memory address of an instruction or data.</p>
<ol>
<li>Convenient way for accessing an instruction in memory, especially when doing branching &amp; looping</li>
<li>Accessing a data item in memory (label as a variable)</li>
<li>Used to represent a defined constant value</li>
</ol>
<h4 id="Op2"><a href="#Op2" class="headerlink" title="Op2"></a>Op2</h4><p>Operand2 – a flexible 2<sup>nd</sup> operand. Available to some Arithmetic/Logical &amp; Move instructions.</p>
<ol>
<li>Constant (aka Immediate)</li>
<li>Register (with optional shift)</li>
</ol>
<h4 id="Pre-amp-Suffix"><a href="#Pre-amp-Suffix" class="headerlink" title="Pre- &amp; Suffix"></a>Pre- &amp; Suffix</h4><p>An Arithmetic or Logical instruction can have:</p>
<ol>
<li><p>Prefix S- or U-</p>
<p>S: perform signed operation of the instruction</p>
<p>U: perform unsigned operation of the instruction</p>
</li>
<li><p>Suffix -S (optional)</p>
<p>op{S}: updates condition code flags according to the result of Arithmetic/Logical or Move operation, op</p>
</li>
</ol>
<h4 id="Condition-Flags"><a href="#Condition-Flags" class="headerlink" title="Condition Flags"></a>Condition Flags</h4><ul>
<li><strong>N</strong>: Set to 1 when the result of the operation is negative, cleared to 0 otherwise</li>
<li><strong>Z</strong>: Set to 1 when the result of the operation is zero, cleared to 0 otherwise</li>
<li><strong>C</strong>: Set to 1 when the operation results in a carry, or when a subtraction results in no borrow, cleared to 0 otherwise</li>
<li><strong>V</strong>: Set to 1 when the operation causes overflow, cleared to 0 otherwise</li>
</ul>
<p><strong>C</strong> is set in one of the following ways:</p>
<ul>
<li>For an addition, including the comparison instruction <code>CMN</code>, <strong>C</strong> is set to 1 if the addition produced a carry (that is, an unsigned overflow), and to 0 otherwise.</li>
<li>For a subtraction, including the comparison instruction <code>CMP</code>, <strong>C</strong> is set to 0 if the subtraction produced a borrow (that is, an unsigned underflow), and to 1 otherwise.</li>
<li>For non-addition/subtractions that incorporate a shift operation, <strong>C</strong> is set to the last bit shifted out of the value by the shifter.</li>
<li>For other non-addition/subtractions, <strong>C</strong> is normally left unchanged, but see the individual instruction descriptions for any special cases.</li>
</ul>
<p>Overflow occurs if the result of a signed add, subtract, or compare is greater than or equal to 2<sup>31</sup>, or less than -2<sup>31</sup>.</p>
<h2 id="Memory-Addressing"><a href="#Memory-Addressing" class="headerlink" title="Memory Addressing"></a>Memory Addressing</h2><h3 id="Memory-Allocation-for-Data"><a href="#Memory-Allocation-for-Data" class="headerlink" title="Memory Allocation for Data"></a>Memory Allocation for Data</h3><p>Data declarations, by using assembler directive(s) at the end of an asm program/function:</p>
<ul>
<li><p>Constants (using .word)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NUM1: .word 123, 456</span><br><span class="line">POINTER: .word NUM1+4</span><br></pre></td></tr></table></figure></li>
<li><p>Static Variables (using .lcomm)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.lcomm ANSWER 4 @ reserves 4 bytes (1 word)</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="4.png"></p>
<p>Static variables retain their values even when the function exits. NUM1, POINTER and ANSWER are all labels.</p>
<h3 id="Offset-Addressing"><a href="#Offset-Addressing" class="headerlink" title="Offset Addressing"></a>Offset Addressing</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LDR/STR Rt, [Rn &#123;, #offset&#125;]</span><br></pre></td></tr></table></figure>

<p><code>LDR</code>: loads register Rt with value from stated memory</p>
<p><code>STR</code>: stores value in register Rt to stated memory</p>
<p>Rn: the base register, contains the address of the memory location</p>
<p>If an offset is present, its value is added to (or subtracted from) the address obtained from the base register Rn. The result (aka the effective address, EA) is used as the address for the memory access.</p>
<p>The value in base register Rn is unaltered.</p>
<h3 id="Offset-Addressing-with-Pre-Post-Index"><a href="#Offset-Addressing-with-Pre-Post-Index" class="headerlink" title="Offset Addressing with Pre/Post Index"></a>Offset Addressing with Pre/Post Index</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LDR/STR Rt, [Rn, #offset]! @ pre-indexed addressing</span><br><span class="line">LDR/STR Rt, [Rn], #offset @ post-indexed addressing</span><br></pre></td></tr></table></figure>

<ul>
<li>Pre-indexed addressing<ol>
<li>The offset value is added to (or subtracted from, if offset is negative) the address obtained from the base register Rn.</li>
<li>The result is used as the Effective Address (EA) for the memory access and it is written back into the Rn.</li>
</ol>
</li>
<li>Post-indexed addressing<ol>
<li>The address obtained from the base register Rn is used as the EA.</li>
<li>The offset value is added to (or subtracted from) the address, and it is written back into the register Rn after the memory access.</li>
</ol>
</li>
</ul>
<h3 id="PC-Relative-Addressing-Load-only"><a href="#PC-Relative-Addressing-Load-only" class="headerlink" title="PC-Relative Addressing (Load only)"></a>PC-Relative Addressing (Load only)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LDR Rd, ITEM</span><br></pre></td></tr></table></figure>

<p><code>LDR</code> loads a register with the value from a PC-relative memory address that is specified by a label.</p>
<p>The base register is always the PC. Location of data is always relative to that of the instruction. The offset is calculated by the assembler.</p>
<h3 id="Pseudo-Instruction-Load-only"><a href="#Pseudo-Instruction-Load-only" class="headerlink" title="Pseudo-Instruction (Load only)"></a>Pseudo-Instruction (Load only)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LDR R1, =0xA123B456 @ loading a 32-bit value</span><br></pre></td></tr></table></figure>

<p>↓</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LDR R1, MEMLOC</span><br><span class="line">MEMLOC: .word 0xA123B456</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LDR R3, =NUM1 @ loading an address (represented by a label)</span><br></pre></td></tr></table></figure>

<p>↓</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LDR R3, POINTER</span><br><span class="line">NUM1: .word 123</span><br><span class="line">POINTER: .word NUM1</span><br></pre></td></tr></table></figure>

<p>The assembler will convert it into PC-relative <code>LDR</code>. Useful for direct loading of long values/memory addresses.</p>
<h2 id="ARMv7-M-Ctrl-amp-Arithmetic-Instructions"><a href="#ARMv7-M-Ctrl-amp-Arithmetic-Instructions" class="headerlink" title="ARMv7-M Ctrl &amp; Arithmetic Instructions"></a>ARMv7-M Ctrl &amp; Arithmetic Instructions</h2><h3 id="Move-Instructions"><a href="#Move-Instructions" class="headerlink" title="Move Instructions"></a>Move Instructions</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MOV Rd, Op2</span><br><span class="line">MOVW Rd, #imm16</span><br></pre></td></tr></table></figure>

<p>Transfer to a register (Rd) an immediate constant value or from another register.</p>
<h3 id="Arithmetic-Instructions-ADD-SUB"><a href="#Arithmetic-Instructions-ADD-SUB" class="headerlink" title="Arithmetic Instructions: ADD, SUB"></a>Arithmetic Instructions: ADD, SUB</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ADD/SUB &#123;Rd,&#125; Rn, Op2</span><br><span class="line">ADD/SUB &#123;Rd,&#125; Rn, #imm12</span><br></pre></td></tr></table></figure>

<p>Add &amp; Subtract.</p>
<p>If Rd is omitted, destination register is Rn.</p>
<h3 id="Arithmetic-Instructions-MUL-MLA"><a href="#Arithmetic-Instructions-MUL-MLA" class="headerlink" title="Arithmetic Instructions: MUL, MLA"></a>Arithmetic Instructions: MUL, MLA</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MUL &#123;Rd,&#125; Rn, Rm</span><br><span class="line">MLA Rd, Rn, Rm, Ra</span><br></pre></td></tr></table></figure>

<p>Multiply &amp; Multiply with Accumulate.</p>
<p>The results of these instructions do not depend on whether the operands are signed or unsigned. Only the least significant 32 bits of the 64-bit results are written to the destination registers.</p>
<p>To get 64-bit results, use the long versions that come with suffix L, in either unsigned (U) or signed (S) variants, see <code>UMULL</code>, <code>UMLAL</code>, <code>SMULL</code>, &amp; <code>SMLAL</code>.</p>
<h3 id="Compare-Instructions"><a href="#Compare-Instructions" class="headerlink" title="Compare Instructions"></a>Compare Instructions</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CMP Rn, Op2</span><br><span class="line">CMN Rn, Op2</span><br></pre></td></tr></table></figure>

<p>Compare &amp; Compare Negative.</p>
<p><code>CMP</code> performs Rn - Op2 while <code>CMN</code> performs Rn + Op2. And then they update condition flags N, Z, C &amp; V based on the result.</p>
<p>If S suffix option is not available to the instruction before a conditional branch, it is very useful to <code>CMP</code>/<code>CMN</code>. </p>
<h3 id="Branch-Instructions-B"><a href="#Branch-Instructions-B" class="headerlink" title="Branch Instructions: B"></a>Branch Instructions: B</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B&#123;cond&#125; label</span><br></pre></td></tr></table></figure>

<p>Branch to location indicated by label if the condition flags satisfy {cond}.</p>
<h3 id="Branch-Instructions-BL-BX"><a href="#Branch-Instructions-BL-BX" class="headerlink" title="Branch Instructions: BL, BX"></a>Branch Instructions: BL, BX</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BL&#123;cond&#125; label @ Branch with Link</span><br></pre></td></tr></table></figure>

<p>Branch to location indicated by label &amp; write the address of the next instruction to LR, usually when calling a subroutine/function.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BX&#123;cond&#125; Rm @ Branch Indirect</span><br></pre></td></tr></table></figure>

<p>Branch to location indicated by Rm.</p>
<h3 id="Branch-Instructions-BLX"><a href="#Branch-Instructions-BLX" class="headerlink" title="Branch Instructions: BLX"></a>Branch Instructions: BLX</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BLX&#123;cond&#125; Rm @ Branch Indirect with Link</span><br></pre></td></tr></table></figure>

<p>Branch to location indicated by Rm &amp; write the address of the next instruction to LR.</p>
<p>When to use what? Usually, in situations similar to:</p>
<ul>
<li>For/While loop; If-Then-Else/Switch-Case: <code>B</code></li>
<li>To jump to a Subroutine/Function: <code>BL</code> or <code>BLX</code></li>
<li>To go back to calling function: <code>BX</code></li>
</ul>
<h2 id="Condition-Code-Suffixes"><a href="#Condition-Code-Suffixes" class="headerlink" title="Condition Code Suffixes"></a>Condition Code Suffixes</h2><table>
<thead>
<tr>
<th>Suffix</th>
<th>Flags</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td><code>EQ</code></td>
<td><code>Z</code> set</td>
<td>Equal</td>
</tr>
<tr>
<td><code>NE</code></td>
<td><code>Z</code> clear</td>
<td>Not equal</td>
</tr>
<tr>
<td><code>CS or HS</code></td>
<td><code>C</code> set</td>
<td>Higher or same (unsigned &gt;= )</td>
</tr>
<tr>
<td><code>CC or LO</code></td>
<td><code>C</code> clear</td>
<td>Lower (unsigned &lt; )</td>
</tr>
<tr>
<td><code>MI</code></td>
<td><code>N</code> set</td>
<td>Negative</td>
</tr>
<tr>
<td><code>PL</code></td>
<td><code>N</code> clear</td>
<td>Positive or zero</td>
</tr>
<tr>
<td><code>VS</code></td>
<td><code>V</code> set</td>
<td>Overflow</td>
</tr>
<tr>
<td><code>VC</code></td>
<td><code>V</code> clear</td>
<td>No overflow</td>
</tr>
<tr>
<td><code>HI</code></td>
<td><code>C</code> set and <code>Z</code> clear</td>
<td>Higher (unsigned &gt;)</td>
</tr>
<tr>
<td><code>LS</code></td>
<td><code>C</code> clear or <code>Z</code> set</td>
<td>Lower or same (unsigned &lt;=)</td>
</tr>
<tr>
<td><code>GE</code></td>
<td><code>N</code> and <code>V</code> the same</td>
<td>Signed &gt;=</td>
</tr>
<tr>
<td><code>LT</code></td>
<td><code>N</code> and <code>V</code> differ</td>
<td>Signed &lt;</td>
</tr>
<tr>
<td><code>GT</code></td>
<td><code>Z</code> clear, <code>N</code> and <code>V</code> the same</td>
<td>Signed &gt;</td>
</tr>
<tr>
<td><code>LE</code></td>
<td><code>Z</code> set, <code>N</code> and <code>V</code> differ</td>
<td>Signed &lt;=</td>
</tr>
<tr>
<td><code>AL</code></td>
<td>Any</td>
<td>Always. This suffix is normally omitted.</td>
</tr>
</tbody></table>
<h2 id="ARMv7-M-Logical-Instructions"><a href="#ARMv7-M-Logical-Instructions" class="headerlink" title="ARMv7-M Logical Instructions"></a>ARMv7-M Logical Instructions</h2><h3 id="Logical-Instructions-AND-ORR-EOR"><a href="#Logical-Instructions-AND-ORR-EOR" class="headerlink" title="Logical Instructions: AND, ORR, EOR"></a>Logical Instructions: AND, ORR, EOR</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">op&#123;S&#125; &#123;Rd,&#125; Rn, Op2</span><br></pre></td></tr></table></figure>

<p>Bit-wise logical AND, OR &amp; Exclusive-OR.</p>
<h3 id="Logical-Instructions-MVN-NOT"><a href="#Logical-Instructions-MVN-NOT" class="headerlink" title="Logical Instructions: MVN (NOT)"></a>Logical Instructions: MVN (NOT)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MVN&#123;S&#125; Rd, Op2</span><br></pre></td></tr></table></figure>

<p>Bit-wise logical NOT.</p>
<h3 id="Logical-Instructions-BIC-ORN"><a href="#Logical-Instructions-BIC-ORN" class="headerlink" title="Logical Instructions: BIC, ORN"></a>Logical Instructions: BIC, ORN</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">op&#123;S&#125; &#123;Rd,&#125; Rn, Op2</span><br></pre></td></tr></table></figure>

<p>Bit Clear &amp; OR NOT.</p>
<p><code>BIC</code> performs an bit-wise AND on the bits in Rn with the complements of the corresponding bits in the value of Op2.</p>
<p><code>ORN</code> performs an bit-wise OR on the bits in Rn with the complements of the corresponding bits in the value of Op2.</p>
<h3 id="Shift-amp-Rotate-Instructions"><a href="#Shift-amp-Rotate-Instructions" class="headerlink" title="Shift &amp; Rotate Instructions"></a>Shift &amp; Rotate Instructions</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">op&#123;S&#125; Rd, Rm, Rs</span><br><span class="line">op&#123;S&#125; Rd, Rm, #n</span><br></pre></td></tr></table></figure>

<p><code>LSL</code>: Logical Shift Left<br><code>LSR</code>: Logical Shift Right<br><code>ASR</code>: Arithmetic Shift Right<br><code>ROR</code>: Rotate Right</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RRX&#123;S&#125; Rd, Rm</span><br></pre></td></tr></table></figure>

<p><code>RRX</code>: Rotate Right with Extend</p>
<p><img src="5.png"></p>
<h3 id="Test-Instructions"><a href="#Test-Instructions" class="headerlink" title="Test Instructions"></a>Test Instructions</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TST Rn, Op2</span><br><span class="line">TEQ Rn, Op2</span><br></pre></td></tr></table></figure>

<p>Test &amp; Test Equivalence.</p>
<p><code>TST</code> performs bit-wise logical AND of the two operands.</p>
<p><code>TEQ</code> performs bit-wise logical Exclusive OR of the two operands.</p>
<p>Both update condition flags. They are similar to <code>ANDS</code> &amp; <code>EORS</code> respectively, but they discard results.</p>
<h3 id="Stack-Instructions"><a href="#Stack-Instructions" class="headerlink" title="Stack Instructions"></a>Stack Instructions</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PUSH reglist</span><br><span class="line">POP reglist</span><br><span class="line">@ reglist is a non-empty list of registers, enclosed in braces.</span><br></pre></td></tr></table></figure>

<p>Common use: to save Register contents before some data processing &amp; then restore those contents from the stack after the processing task is done.</p>
<p>SP (R13) is auto-decremented/incremented respectively.</p>
<hr>
<p>整理自 NUS CG2028 课件，难免有<strong>错漏</strong>并存在<strong>简化</strong>的地方，仅作参考。</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Computer-Architecture/">Computer Architecture</a></div><div class="post_share"><div class="social-share" data-image="/img/bg4.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2021-04-09-01/"><img class="prev-cover" src="/img/bg4.jpg" onerror="onerror=null;src='/img/404.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">计算机组成-知识点整理（下）</div></div></a></div><div class="next-post pull-right"><a href="/posts/2021-03-28-02/"><img class="next-cover" src="/img/bg2.jpg" onerror="onerror=null;src='/img/404.png'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">信号与系统学习笔记#6</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/2021-04-09-01/" title="计算机组成-知识点整理（下）"><img class="cover" src="/img/bg4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-09</div><div class="title">计算机组成-知识点整理（下）</div></div></a></div><div><a href="/posts/2022-09-04-01/" title="Computer Architecture - ARM Instruction Format"><img class="cover" src="/img/bg4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-04</div><div class="title">Computer Architecture - ARM Instruction Format</div></div></a></div><div><a href="/posts/2022-11-03-01/" title="Computer Architecture - Multiprocessor Systems"><img class="cover" src="/img/bg4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-03</div><div class="title">Computer Architecture - Multiprocessor Systems</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.webp" onerror="this.onerror=null;this.src='/img/404.png'" alt="avatar"/></div><div class="author-info__name">Wu Haitao</div><div class="author-info__description">这个人很懒~</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">65</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Wu-Haitao"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wu-Haitao" target="_blank" title="GitHub"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:wuhaitao99.st@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="https://steamcommunity.com/id/Wu_Haitao" target="_blank" title="Steam"><i class="fab fa-steam"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction-amp-Microprocessor-Concepts"><span class="toc-number">1.</span> <span class="toc-text">Introduction &amp; Microprocessor Concepts</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Functional-Units"><span class="toc-number">1.1.</span> <span class="toc-text">Functional Units</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Processor-Components"><span class="toc-number">1.2.</span> <span class="toc-text">Processor Components</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Registers"><span class="toc-number">1.2.1.</span> <span class="toc-text">The Registers</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Memory-Organization"><span class="toc-number">1.3.</span> <span class="toc-text">Memory Organization</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Instructions-amp-Sequencing"><span class="toc-number">1.4.</span> <span class="toc-text">Instructions &amp; Sequencing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RISC-amp-CISC"><span class="toc-number">1.4.1.</span> <span class="toc-text">RISC &amp; CISC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RISC-Instruction-Set"><span class="toc-number">1.4.2.</span> <span class="toc-text">RISC Instruction Set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Instruction-Execution-Sequencing"><span class="toc-number">1.4.3.</span> <span class="toc-text">Instruction Execution&#x2F;Sequencing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Branching-amp-Looping"><span class="toc-number">1.4.4.</span> <span class="toc-text">Branching &amp; Looping</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ARM-Cortex-M3-NXP-LPC1769"><span class="toc-number">2.</span> <span class="toc-text">ARM Cortex-M3 NXP LPC1769</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Introduction"><span class="toc-number">2.0.1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Registers"><span class="toc-number">2.0.2.</span> <span class="toc-text">Registers</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ARM-Instruction-Set-amp-Assembly-Language-ASM"><span class="toc-number">3.</span> <span class="toc-text">ARM Instruction Set &amp; Assembly Language (ASM)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction-to-ARMv7-M"><span class="toc-number">3.1.</span> <span class="toc-text">Introduction to ARMv7-M</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Calling-an-Assembler-Function-from-a-C-Program"><span class="toc-number">3.1.1.</span> <span class="toc-text">Calling an Assembler Function from a C Program</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-Basics"><span class="toc-number">3.1.2.</span> <span class="toc-text">Some Basics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Label"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">Label</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Op2"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">Op2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pre-amp-Suffix"><span class="toc-number">3.1.2.3.</span> <span class="toc-text">Pre- &amp; Suffix</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Condition-Flags"><span class="toc-number">3.1.2.4.</span> <span class="toc-text">Condition Flags</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Memory-Addressing"><span class="toc-number">3.2.</span> <span class="toc-text">Memory Addressing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Memory-Allocation-for-Data"><span class="toc-number">3.2.1.</span> <span class="toc-text">Memory Allocation for Data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Offset-Addressing"><span class="toc-number">3.2.2.</span> <span class="toc-text">Offset Addressing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Offset-Addressing-with-Pre-Post-Index"><span class="toc-number">3.2.3.</span> <span class="toc-text">Offset Addressing with Pre&#x2F;Post Index</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PC-Relative-Addressing-Load-only"><span class="toc-number">3.2.4.</span> <span class="toc-text">PC-Relative Addressing (Load only)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pseudo-Instruction-Load-only"><span class="toc-number">3.2.5.</span> <span class="toc-text">Pseudo-Instruction (Load only)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ARMv7-M-Ctrl-amp-Arithmetic-Instructions"><span class="toc-number">3.3.</span> <span class="toc-text">ARMv7-M Ctrl &amp; Arithmetic Instructions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Move-Instructions"><span class="toc-number">3.3.1.</span> <span class="toc-text">Move Instructions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arithmetic-Instructions-ADD-SUB"><span class="toc-number">3.3.2.</span> <span class="toc-text">Arithmetic Instructions: ADD, SUB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arithmetic-Instructions-MUL-MLA"><span class="toc-number">3.3.3.</span> <span class="toc-text">Arithmetic Instructions: MUL, MLA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compare-Instructions"><span class="toc-number">3.3.4.</span> <span class="toc-text">Compare Instructions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Branch-Instructions-B"><span class="toc-number">3.3.5.</span> <span class="toc-text">Branch Instructions: B</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Branch-Instructions-BL-BX"><span class="toc-number">3.3.6.</span> <span class="toc-text">Branch Instructions: BL, BX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Branch-Instructions-BLX"><span class="toc-number">3.3.7.</span> <span class="toc-text">Branch Instructions: BLX</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Condition-Code-Suffixes"><span class="toc-number">3.4.</span> <span class="toc-text">Condition Code Suffixes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ARMv7-M-Logical-Instructions"><span class="toc-number">3.5.</span> <span class="toc-text">ARMv7-M Logical Instructions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Logical-Instructions-AND-ORR-EOR"><span class="toc-number">3.5.1.</span> <span class="toc-text">Logical Instructions: AND, ORR, EOR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Logical-Instructions-MVN-NOT"><span class="toc-number">3.5.2.</span> <span class="toc-text">Logical Instructions: MVN (NOT)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Logical-Instructions-BIC-ORN"><span class="toc-number">3.5.3.</span> <span class="toc-text">Logical Instructions: BIC, ORN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shift-amp-Rotate-Instructions"><span class="toc-number">3.5.4.</span> <span class="toc-text">Shift &amp; Rotate Instructions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Test-Instructions"><span class="toc-number">3.5.5.</span> <span class="toc-text">Test Instructions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stack-Instructions"><span class="toc-number">3.5.6.</span> <span class="toc-text">Stack Instructions</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Unity-%E5%AD%A6%E4%B9%A0/"><span class="card-category-list-name">Unity 学习</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"><span class="card-category-list-name">前端学习</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">课程学习笔记</span><span class="card-category-list-count">39</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 1.2em; color: #999">C#</a> <a href="/tags/CSS/" style="font-size: 1.2em; color: #999">CSS</a> <a href="/tags/Computer-Architecture/" style="font-size: 1.25em; color: #999">Computer Architecture</a> <a href="/tags/HTML/" style="font-size: 1.2em; color: #999">HTML</a> <a href="/tags/Hexo/" style="font-size: 1.15em; color: #999">Hexo</a> <a href="/tags/Java/" style="font-size: 1.1em; color: #999">Java</a> <a href="/tags/Latex/" style="font-size: 1.1em; color: #999">Latex</a> <a href="/tags/Unity/" style="font-size: 1.35em; color: #999">Unity</a> <a href="/tags/WPF/" style="font-size: 1.1em; color: #999">WPF</a> <a href="/tags/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F/" style="font-size: 1.4em; color: #999">信号与系统</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.35em; color: #999">前端</a> <a href="/tags/%E5%8F%8D%E9%A6%88%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F/" style="font-size: 1.5em; color: #999">反馈控制系统</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.1em; color: #999">数据结构</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 1.45em; color: #999">机器学习</a> <a href="/tags/%E6%B8%B8%E6%88%8F%E7%9B%B8%E5%85%B3/" style="font-size: 1.1em; color: #999">游戏相关</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.3em; color: #999">算法</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 1.5em; color: #999">计算机网络</a></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Wu Haitao</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
btf.isJqueryLoad(function() {
  $(window).on('load', function() {
    preloader.endLoading();
  });
});</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadWaline () {
  function insertCSS () {
    const link = document.createElement("link")
    link.rel = "stylesheet"
    link.href = "https://unpkg.com/@waline/client@v2/dist/waline.css"
    document.head.appendChild(link)
  }

  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://my-project-wu-haitao.vercel.app/',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      imageUploader: false,
      path: window.location.pathname,
      comment: false,
    }, null))
  }

  if (typeof Waline === 'function') initWaline()
  else {
    insertCSS()
    getScript('https://unpkg.com/@waline/client@v2/dist/waline.js').then(initWaline)
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><script id="canvas_nest" defer="defer" color="255,255,255" opacity="0.8" zIndex="-1" count="99" mobile="false" src="/js/canvas-nest.min.js"></script><script src="/js/removeBG.js"></script><script src="/js/FunnyTitle.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = false;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="/js/ClickShowText.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script></div><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
btf.isJqueryLoad(function() {
  $(window).on('load', function() {
    preloader.endLoading();
  });
});</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"superSample":2,"position":"right","hOffset":50,"vOffset":-25},"mobile":{"show":false},"log":false});</script></body></html>